services:
  - type: web
    name: n8n
    env: docker
    plan: starter
    region: frankfurt                  # choisis ta région (Frankfurt = EU)
    autoDeploy: true                   # redeploiement auto quand tu pousses du code
    dockerfilePath: ./Dockerfile       # Render utilisera ton Dockerfile

    # 📦 Ajout d’un disque persistant (1 Go)
    disk:
      - name: data
        mountPath: /home/node/.n8n     # dossier où n8n stocke ses fichiers
        sizeGB: 1

    envVars:
      # 🌍 Configuration générale
      - key: GENERIC_TIMEZONE
        value: Europe/Paris
      - key: N8N_PROTOCOL
        value: https
      - key: N8N_PORT
        value: "5678"

      # 🖥️ Remplace par ton nom d’app Render (ex: mon-n8n.onrender.com)
      - key: N8N_HOST
        value: n8n-appv.onrender.com
      - key: WEBHOOK_URL
        value: https://ton-app.onrender.com

      # 🔐 Clé de chiffrement (générée automatiquement)
      - key: N8N_ENCRYPTION_KEY
        generateValue: true

      # 📊 Désactiver la télémétrie
      - key: N8N_DIAGNOSTICS_ENABLED
        value: "false"

      # 🔒 Sécuriser l’accès à ton instance avec Basic Auth
      - key: N8N_BASIC_AUTH_ACTIVE
        value: "true"
      - key: N8N_BASIC_AUTH_USER
        value: admin
      - key: N8N_BASIC_AUTH_PASSWORD
        generateValue: true
